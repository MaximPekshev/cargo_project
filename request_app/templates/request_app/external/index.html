{%load static%}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{%static 'css/request_app/external/external_request_app.css'%}">
    <link rel="stylesheet" href="{% static 'css/select2.min.css' %}" />
    <link rel="stylesheet" href="{% static 'css/select2-bootstrap.min.css' %}" />
    <script src="{% static 'js/select2.min.js' %}"></script>
    <link rel="shortcut icon"
              href="{% static "favicon.png" %}"
              type="image/png">
    <title>Список грузов</title>
</head>


<body>
    <div class="searchDiv">
        <h2>Поиск</h2>

        <div style="margin-bottom: 20px;">
            <select class="js-example-basic-single" id="city" name="city">
                {% for item in cities %}
                <option value="{{ item.title }}">{{ item.title }}</option>
                {% endfor %}
            </select>
        </div>
        
        <select name="load" id="load">
            <option  value="unloading">Выгрузка</option>
            <option  value="loading">Загрузка</option>
            <option selected value="none">Загрузка/Выгрузка</option>
          </select>
          <br><br>
        <input id="radius" placeholder="Радиус 50/100/200" type="number">
        <button class="submitButton">Найти</button>
    </div>
    <script>
        $('.submitButton').on('click', function () {
            select = document.getElementById("load")
            value = select.options[select.selectedIndex].value
            
            city = document.getElementById("city")
            city_value = city.options[city.selectedIndex].value
            radius = document.getElementById('radius').value
            if (city_value && radius){
                if (value != 'none'){
                    location.href = 'search/city=' + city_value + ';load=' + value + ';radius=' + radius + '/'+'?city=' + city_value + '&load=' + value + '&radius=' + radius
                }else{
                    location.href = 'search/city=' + city_value +';radius=' + radius + '/'+'?city=' + city_value + '&radius=' + radius
                }
                document.getElementById('city').style.border = '1px solid black'
            } else if (city_value && !radius) {
                if (value != 'none'){
                    location.href = 'search/city=' + city_value + ';load=' + value + '/'+'?city=' + city_value + '&load=' + value
                }else{
                    location.href = 'search/city='+ city_value + '/'+'?city=' + city_value
                }
                document.getElementById('city').style.border = '1px solid black'
            }else{
                location.href = 'search/'
            }
        })
    </script>
    
    <script type="text/javascript">
        $(document).ready(function() {
          $('.js-example-basic-single').select2({
            {% comment %} width : 'resolve'  {% endcomment %}
            theme : 'bootstrap'
          });
        });
    </script>
    <!-- $('.submitButton').on('click', function () {
        text = document.getElementById('text').value
        number = document.getElementById('number').value
        if (text){
            if(number){
                document.getElementById('number').style.border = '1px solid black'
                location.href = 'search/city='+text+';radius='+number
            }else{
                document.getElementById('number').style.border = '1px solid red'
            }
            document.getElementById('text').style.border = '1px solid black'
        }else{
            document.getElementById('text').style.border = '1px solid red'
        }
    }) -->
</html>